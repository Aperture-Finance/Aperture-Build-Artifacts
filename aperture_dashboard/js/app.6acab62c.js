(function(t){function e(e){for(var n,o,a=e[0],u=e[1],l=e[2],m=0,p=[];m<a.length;m++)o=a[m],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(t[n]=u[n]);c&&c(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,a=1;a<i.length;a++){var u=i[a];0!==r[u]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},r={app:0},s=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var c=u;s.push([1,"chunk-vendors"]),i()})({0:function(t,e){},"034f":function(t,e,i){"use strict";i("85ec")},1:function(t,e,i){t.exports=i("56d7")},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},"56bb":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("img",{attrs:{alt:"Aperture logo",src:i("cf05")}}),n("Metrics")],1)},s=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hello"},[t.isLoading?i("h1",[t._v("Loading...")]):t._e(),t.isLoading?t._e():i("div",[i("h1",[t._v("Aperture Dashboard")]),i("h3",[t._v("Aggregated from positions:")]),i("p",[t._v(t._s(t.getCompletedPositionQueries)+" / "+t._s(t.getNumPositions))]),i("h3",[t._v("Total value of open positions (TVL)")]),i("p",[t._v(t._s(t.getTVL))]),i("h3",[t._v("Total initial investment size of open positions")]),i("p",[t._v(t._s(t.getSumOpenPositionInitialSizes))]),i("h3",[t._v("Total initial investment size of ALL positions")]),i("p",[t._v(t._s(t.getSumAllPositionInitialSizes))]),i("h3",[t._v("Total contribution to Spectrum TVL from open positions")]),i("p",[t._v(t._s(t.getSumOpenPositionSpectrumTVLContributions))]),i("h3",[t._v("Sum of unrealized gain across open positions with unrealized gain")]),i("p",[t._v(t._s(t.getSumUnrealizedGain))]),i("h3",[t._v("Sum of short farm UST value across open positions")]),i("p",[t._v(t._s(t.getSumShortFarmValueAcrossOpenPositions))]),i("h3",[t._v(" Sum of short farm UST value across open positions with unrealized gain ")]),i("p",[t._v(" "+t._s(t.getSumShortFarmValueAcrossOpenPositionsWithUnrealizedGain)+" ")]),i("GChart",{staticStyle:{height:"600px"},attrs:{type:"BarChart",data:t.getCountChartData,options:t.countChartOptions}}),i("GChart",{staticStyle:{height:"600px"},attrs:{type:"BarChart",data:t.getSumChartData,options:t.sumChartOptions}}),i("h3",[t._v("TVL per mAsset")]),i("table",{staticStyle:{"margin-left":"auto","margin-right":"auto"}},[t._m(0),t._l(t.mAssetToTVL,(function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s(n))]),i("td",[t._v(t._s(e.toFormat(6)))])])}))],2),i("h3",[t._v("Total Positions")]),i("p",[t._v(t._s(t.openedPositions.length+t.closedPositions.length))]),i("h3",[t._v("Open Positions")]),i("ul",[i("li",[t._v(" "+t._s(t.openedPositions.length)+" ")])]),i("h3",[t._v("Total Closed Positions")]),i("ul",[i("li",[t._v(" "+t._s(t.closedPositions.length)+" ")])]),i("h3",[t._v("Unique Position Holders: "+t._s(Object.keys(t.uniqueWallets).length))]),i("ul",t._l(t.uniqueWallets,(function(e,n){return i("li",{key:n},[t._v(" "+t._s(n)+": "+t._s(e)+" ")])})),0)],1)])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("th",[t._v("mAsset")]),i("th",[t._v("TVL")])])}],u=i("b85c"),l=i("1da1"),c=i("2909"),m=(i("96cf"),i("d81d"),i("d3b7"),i("ddb0"),i("0481"),i("4069"),i("a15b"),i("25f0"),i("07ac"),i("4e82"),i("cb43")),p=i("b8b0"),d=i("901e"),h=i("bc3a"),f=i.n(h),v=i("6434");d["BigNumber"].config({FORMAT:{prefix:"$",decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0,suffix:""}});var g={terra1vxtwu4ehgzz77mnfwrntyrmgl64qjs75mpwqaz:"mAAPL",terra14y5affaarufk3uscy2vr6pe6w6zqf2wpjzn5sh:"mTSLA",terra1jsxngqasf2zynj5kyh0tgq9mj3zksa5gk35j4k:"mNFLX",terra1dk3g53js3034x4v5c3vavhj2738une880yu6kx:"mETH",terra1csk6tc7pdmpr782w527hwhez6gfv632tyf72cp:"mQQQ",terra1cc3enj9qgchlrj34cnzhwuclc4vl2z3jl7tkqg:"mTWTR",terra1227ppwxxj3jxz8cfgq00jgnxqcny7ryenvkwj6:"mMSFT",terra165nd2qmrtszehcfrntlplzern7zl4ahtlhd5t2:"mAMZN",terra1w7zgkcyt7y4zpct9dw8mw362ywvdlydnum2awa:"mBABA",terra10h7ry7apm55h4ez502dqdv9gr53juu85nkd4aq:"mIAU",terra1kscs6uhrqwy6rx5kuw5lwpuqvm3t6j2d6uf2lp:"mSLV",terra1lvmx8fsagy70tv0fhmfzdw9h6s3sy4prz38ugf:"mUSO",terra19cmt6vzvhnnnfsmccaaxzy2uaj06zjktu6yzjx:"mVIXY",terra1mqsjugsugfprn3cvgxsrr8akkvdxv2pzc74us7:"mFB",terra1h8arz2k547uvmpxctuwush3jzc8fun4s96qgwt:"mGOOGL",terra18wayjpyq28gd970qzgjfmsjj7dmgdk039duhph:"mCOIN",terra18yqdfzfhnguerz9du5mnvxsh5kxlknqhcxzjfr:"mHOOD",terra1qqfx5jph0rsmkur2zgzyqnfucra45rtjae5vh6:"mARKK",terra1l5lrxtwd98ylfy09fn866au6dp76gu8ywnudls:"mGLXY",terra1u43zu5amjlsgty5j64445fr9yglhm53m576ugh:"mSQ",terra1g4x2pzmkc9z3mseewxf758rllg08z3797xly0n:"mABNB",terra1aa00lpfexyycedfg5k2p60l9djcmw0ue5l8fhc:"mSPY",terra19ya4jpvjvvtggepvmmj6ftmwly3p7way0tt08r:"mDOT",terra18ej5nsuu867fkx4tuy2aglpvqjrkcrjjslap3z:"mAMD",terra137drsu8gce5thf6jr5mxlfghw36rpljt3zj73v:"mGS",terra1qsnj5gvq8rgs7yws8x5u02gwd5wvtu4tks0hjm:"mKO",terra1rh2907984nudl7vh56qjdtvv7947z4dujj92sx:"mPYPL",terra1246zy658dfgtausf0c4a6ly8sc2e285q4kxqga:"mSBUX",terra1ptdxmj3xmmljzx02nr4auwfuelmj0cnkh8egs2:"mJNJ",terra1rhhvx8nzfrx5fufkuft06q5marfkucdqwq5sjw:"mBTC",terra1drsjzvzej4h4qlehcfwclxg4w5l3h5tuvd3jd8:"mNVDA",terra1dj2cj02zak0nvwy3uj9r9dhhxhdwxnw6psse6p:"mNIO",terra149755r3y0rve30e209awkhn5cxgkn5c8ju9pm5:"mDIS",terra17ana8hvzea0q7w367dm0dw48sxwql39qekpt7g:"mNKE"},b=[500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e100];function j(t,e){return t>=e?[]:Object(c["a"])(Array(e-t).keys()).map((function(e){return e+t}))}var _={name:"Metrics",props:{},components:{GChart:m["GChart"]},mounted:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.init(),e.next=3,t.crunchData();case 3:case"end":return e.stop()}}),e)})))()},data:function(){return{client:void 0,uniqueWallets:{},openedPositions:[],closedPositions:[],initialInvestmentUSTOpenPositions:[],initialInvestmentUSTAllPositions:[],numPositions:0,completedPositionQueries:0,tvl:Object(d["BigNumber"])(0),sumOpenPositionInitialSizes:Object(d["BigNumber"])(0),sumAllPositionInitialSizes:Object(d["BigNumber"])(0),sumOpenPositionSpectrumTVLContributions:Object(d["BigNumber"])(0),sumUnrealizedGain:Object(d["BigNumber"])(0),sumShortFarmValueAcrossOpenPositions:Object(d["BigNumber"])(0),sumShortFarmValueAcrossOpenPositionsWithUnrealizedGain:Object(d["BigNumber"])(0),mAssetToTVL:{},countChartOptions:{title:"Initial Investment UST Size (bucketed counts)",bars:"horizontal"},sumChartOptions:{title:"Initial Investment UST Size (bucketed sum)",bars:"horizontal"},isLoading:!0}},computed:{getCountChartData:function(){var t,e=[["Range","Active Positions (count)","All Positions (count)"],["(0, $500]",0,0],["($500, $1,000]",0,0],["($1,000, 2,000]",0,0],["($2,000, 5,000]",0,0],["($5,000, 10,000]",0,0],["($10,000, 20,000]",0,0],["($20,000, 50,000]",0,0],["($50,000, 100,000]",0,0],["($100,000, 200,000]",0,0],["($200,000, 500,000]",0,0],["($500,000, Infinity)",0,0]],i=Object(u["a"])(this.initialInvestmentUSTOpenPositions);try{for(i.s();!(t=i.n()).done;){var n,r=t.value,s=0,o=Object(u["a"])(b);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(r<=a)break;s++}}catch(v){o.e(v)}finally{o.f()}e[s+1][1]++}}catch(v){i.e(v)}finally{i.f()}var l,c=Object(u["a"])(this.initialInvestmentUSTAllPositions);try{for(c.s();!(l=c.n()).done;){var m,p=l.value,d=0,h=Object(u["a"])(b);try{for(h.s();!(m=h.n()).done;){var f=m.value;if(p<=f)break;d++}}catch(v){h.e(v)}finally{h.f()}e[d+1][2]++}}catch(v){c.e(v)}finally{c.f()}return e},getSumChartData:function(){var t,e=[["Range","Active Positions (sum)","All Positions (sum)"],["(0, $500]",0,0],["($500, $1,000]",0,0],["($1,000, 2,000]",0,0],["($2,000, 5,000]",0,0],["($5,000, 10,000]",0,0],["($10,000, 20,000]",0,0],["($20,000, 50,000]",0,0],["($50,000, 100,000]",0,0],["($100,000, 200,000]",0,0],["($200,000, 500,000]",0,0],["($500,000, Infinity)",0,0]],i=Object(u["a"])(this.initialInvestmentUSTOpenPositions);try{for(i.s();!(t=i.n()).done;){var n,r=t.value,s=0,o=Object(u["a"])(b);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(r<=a)break;s++}}catch(v){o.e(v)}finally{o.f()}e[s+1][1]+=r}}catch(v){i.e(v)}finally{i.f()}var l,c=Object(u["a"])(this.initialInvestmentUSTAllPositions);try{for(c.s();!(l=c.n()).done;){var m,p=l.value,d=0,h=Object(u["a"])(b);try{for(h.s();!(m=h.n()).done;){var f=m.value;if(p<=f)break;d++}}catch(v){h.e(v)}finally{h.f()}e[d+1][2]+=p}}catch(v){c.e(v)}finally{c.f()}return e},getNumPositions:function(){return this.numPositions},getCompletedPositionQueries:function(){return this.completedPositionQueries},getTVL:function(){return this.tvl.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumOpenPositionInitialSizes:function(){return this.sumOpenPositionInitialSizes.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumAllPositionInitialSizes:function(){return this.sumAllPositionInitialSizes.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumOpenPositionSpectrumTVLContributions:function(){return this.sumOpenPositionSpectrumTVLContributions.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumUnrealizedGain:function(){return this.sumUnrealizedGain.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumShortFarmValueAcrossOpenPositions:function(){return this.sumShortFarmValueAcrossOpenPositions.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)},getSumShortFarmValueAcrossOpenPositionsWithUnrealizedGain:function(){return this.sumShortFarmValueAcrossOpenPositionsWithUnrealizedGain.dividedBy(Object(d["BigNumber"])(1e6)).toFormat(6)}},methods:{init:function(){for(var t in console.log("initializing..."),this.client=new p["LCDClient"]({URL:"https://lcd.terra.dev/",chainID:"columbus-5"}),g)this.mAssetToTVL[g[t]]=Object(d["BigNumber"])(0)},crunchData:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var i,n,r,s,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.client){e.next=3;break}return console.log("Client is uninitialized."),e.abrupt("return");case 3:return i="terra1ajkmy2c0g84seh66apv9x6xt6kd3ag80jmcvtz",n=t.client,e.next=7,n.wasm.contractQuery(i,{get_next_position_id:{}});case 7:return r=e.sent,t.numPositions=r.next_position_id,console.log("next position id: ",r.next_position_id),s=parseInt(r.next_position_id),o=500,a=Math.ceil(s/o),e.next=15,Object(v["a"])({collection:j(0,a),maxConcurrency:5,task:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var i,n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e*o,n=Math.min(i+o,s),r="{"+j(i,n).map((function(t){return"q"+t+':wasm{contractQuery(contractAddress:"terra1jvehz6d9gk3gl4tldrzd8qzj8zfkurfvtcg99x"query:{batch_get_position_info:{positions:[{chain_id:3,position_id:"'+t.toString()+'"}]}})}'})).join()+"}",t.next=5,f()({method:"post",url:"https://solitary-wind-b421.hyperfocal-dev.workers.dev/graphql",data:{query:r}});case 5:return a=t.sent,t.abrupt("return",Object.values(a.data.data).map((function(t){return t.contractQuery.items[0]})));case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()});case 15:u=e.sent.flat(),u.map((function(e){t.processPositionResult(e)})),t.isLoading=!1,t.openedPositions.sort(),t.closedPositions.sort(),t.isMounted=!0;case 21:case"end":return e.stop()}}),e)})))()},processPositionResult:function(t){var e=t.holder;e in this.uniqueWallets?this.uniqueWallets[e]++:this.uniqueWallets[e]=1;var i=t.info,n=t.position.position_id,r=i.position_open_info.uusd_amount;this.sumAllPositionInitialSizes=this.sumAllPositionInitialSizes.plus(r);var s=Object(d["BigNumber"])(r)/1e6;if(this.initialInvestmentUSTAllPositions.push(s),null==i.detailed_info)this.closedPositions.push(n);else{this.openedPositions.push(n),this.initialInvestmentUSTOpenPositions.push(s),this.sumOpenPositionInitialSizes=this.sumOpenPositionInitialSizes.plus(i.position_open_info.uusd_amount),this.sumOpenPositionSpectrumTVLContributions=this.sumOpenPositionSpectrumTVLContributions.plus(Object(d["BigNumber"])(i.detailed_info.state.uusd_long_farm).multipliedBy(2));var o=Object(d["BigNumber"])(i.detailed_info.state.mirror_asset_short_amount).times(Object(d["BigNumber"])(i.detailed_info.state.mirror_asset_oracle_price));this.sumShortFarmValueAcrossOpenPositions=this.sumShortFarmValueAcrossOpenPositions.plus(o),Object(d["BigNumber"])(i.detailed_info.uusd_value)>Object(d["BigNumber"])(i.position_open_info.uusd_amount)&&(this.sumShortFarmValueAcrossOpenPositionsWithUnrealizedGain=this.sumShortFarmValueAcrossOpenPositionsWithUnrealizedGain.plus(o),this.sumUnrealizedGain=this.sumUnrealizedGain.plus(Object(d["BigNumber"])(i.detailed_info.uusd_value)-Object(d["BigNumber"])(i.position_open_info.uusd_amount))),this.tvl=this.tvl.plus(Object(d["BigNumber"])(i.detailed_info.uusd_value));var a=i.mirror_asset_cw20_addr,u=g[a];u in this.mAssetToTVL?this.mAssetToTVL[u]=this.mAssetToTVL[u].plus(Object(d["BigNumber"])(i.detailed_info.uusd_value).dividedBy(Object(d["BigNumber"])(1e6))):this.mAssetToTVL[u]=Object(d["BigNumber"])(i.detailed_info.uusd_value).dividedBy(Object(d["BigNumber"])(1e6))}this.completedPositionQueries++}}},y=_,O=(i("e94c"),i("2877")),z=Object(O["a"])(y,o,a,!1,null,"30602770",null),S=z.exports,P={name:"App",components:{Metrics:S}},w=P,x=(i("034f"),Object(O["a"])(w,r,s,!1,null,null,null)),k=x.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(k)}}).$mount("#app")},6:function(t,e){},7:function(t,e){},"85ec":function(t,e,i){},cf05:function(t,e,i){t.exports=i.p+"img/logo.9f25601d.png"},e94c:function(t,e,i){"use strict";i("56bb")}});
//# sourceMappingURL=app.6acab62c.js.map